:root {
    --bg-color: #0f172a;
    --panel-bg: rgba(30, 41, 59, 0.85);
    --neon-glow: 0 0 15px rgba(56, 189, 248, 0.5);
    --primary: #3b82f6;
    --danger: #ef4444;
    --text: #e2e8f0;
}

body {
    margin: 0;
    overflow: hidden;
    background-color: var(--bg-color);
    font-family: 'Tajawal', sans-serif;
    color: var(--text);
    height: 100vh;
    touch-action: none; /* Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ¨ÙŠØ± Ø¨Ø§Ù„Ù„Ù…Ø³ */
}

/* Ø´Ø§Ø´Ø© Ø§Ù„Ù‚ÙÙ„ */
.login-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: #0f172a; z-index: 9999;
    display: flex; justify-content: center; align-items: center;
}
.login-box {
    background: rgba(20, 0, 0, 0.95); padding: 30px; border-radius: 16px;
    text-align: center; 
    border: 2px solid #ffd700; /* Ø°Ù‡Ø¨ÙŠ */
    box-shadow: 0 0 20px #ffd700, inset 0 0 20px #ffd700;
    backdrop-filter: blur(10px);
    min-width: 300px;
}
.login-box h2 {
    color: #ffd700;
    text-shadow: 0 0 10px #ff0033;
    margin-bottom: 20px;
}

.login-input {
    padding: 12px; border-radius: 8px; margin: 10px auto;
    width: 85%; text-align: center; font-size: 1.1rem; display: block;
    font-family: inherit;
    border: 1px solid #ff0033; /* Ø£Ø­Ù…Ø± Ù†ÙŠÙˆÙ† */
    color: #ffd700;
    background: rgba(50, 0, 0, 0.6);
    box-shadow: 0 0 5px #ff0033;
    transition: 0.3s;
}
.login-input:focus {
    outline: none;
    box-shadow: 0 0 15px #ff0033;
    background: rgba(80, 0, 0, 0.8);
}

#loginBtn {
    background: linear-gradient(45deg, #ff0033, #990000);
    color: #ffd700;
    font-weight: bold;
    box-shadow: 0 0 15px #ff0033;
    text-shadow: 0 0 5px #ffd700;
    border: 1px solid #ffd700;
    width: 90%;
    margin-top: 15px;
}
#loginBtn:hover {
    background: #cc0000;
    box-shadow: 0 0 25px #ff0033;
    transform: scale(1.05);
}

/* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
.main-header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    background: var(--panel-bg);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border-bottom: 1px solid rgba(255,255,255,0.1);
    z-index: 1000;
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 4px 30px rgba(0,0,0,0.3);
}

.main-header.closed {
    transform: translateY(-100%);
}

.header-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 20px;
    gap: 20px;
    min-height: 60px; /* Ø§Ø±ØªÙØ§Ø¹ Ø£Ù‚Ù„ */
}

/* Ø²Ø± Ø§Ù„ÙØªØ­ ÙˆØ§Ù„Ø¥ØºÙ„Ø§Ù‚ */
.toggle-handle {
    position: absolute;
    bottom: -24px;
    left: 50%;
    transform: translateX(-50%);
    width: 60px;
    height: 24px;
    background: var(--panel-bg);
    border: 1px solid rgba(255,255,255,0.1);
    border-top: none;
    border-radius: 0 0 12px 12px;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    color: var(--text);
    backdrop-filter: blur(15px);
}

.toggle-handle .arrow {
    font-size: 12px;
    transition: transform 0.3s;
}

.main-header.closed .toggle-handle .arrow {
    transform: rotate(180deg);
}

/* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙ…Ø±ÙŠØ± */
.tools-scroll-area {
    display: flex;
    align-items: center;
    gap: 10px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª */
    flex: 1;
    overflow-x: auto;
    padding-bottom: 5px; /* Ù„Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± */
    scrollbar-width: none; /* Ø§Ø®ÙØ§Ø¡ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„ÙØ§ÙŠØ±ÙÙˆÙƒØ³ */
}
.tools-scroll-area::-webkit-scrollbar { display: none; }

.tool-group {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-width: auto; /* Ø¹Ø±Ø¶ ØªÙ„Ù‚Ø§Ø¦ÙŠ */
    background: rgba(255, 255, 255, 0.03);
    padding: 4px 8px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø­ÙˆØ§Ù */
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.05);
}

.tool-group label {
    font-size: 0.65rem; /* ØªØµØºÙŠØ± Ø§Ù„Ø®Ø· */
    color: #94a3b8;
    margin-bottom: 3px;
}

/* ØµÙÙˆÙ Ø§Ù„Ø£Ù„ÙˆØ§Ù† */
.color-row { display: flex; gap: 6px; }
.color-dot {
    width: 20px; height: 20px; /* ØªØµØºÙŠØ± Ø§Ù„Ù†Ù‚Ø§Ø· */
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid rgba(255,255,255,0.1);
    transition: transform 0.2s, border-color 0.2s;
}
.color-dot:hover, .color-dot.active { transform: scale(1.2); border-color: white; box-shadow: 0 0 10px rgba(255,255,255,0.3); }

.mini-picker {
    width: 20px; height: 20px;
    border: none;
    padding: 0;
    background: none;
    cursor: pointer;
    border-radius: 50%;
    overflow: hidden;
}

.icon-btn {
    background: none; border: 1px solid rgba(255,255,255,0.2);
    border-radius: 50%; width: 24px; height: 24px; cursor: pointer;
    color: white; display: flex; align-items: center; justify-content: center;
}
.icon-btn:hover { background: rgba(255,255,255,0.1); }

.user-count-btn {
    background: rgba(255,255,255,0.1); padding: 4px 12px; border-radius: 12px; font-size: 0.9rem;
    border: 1px solid rgba(255,255,255,0.2); color: white; cursor: pointer;
}
.user-count-btn:hover { background: rgba(255,255,255,0.2); }

.status-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: #22c55e;
    box-shadow: 0 0 10px #22c55e;
}

/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø¤Ø´Ø± */
.cursor-options { display: flex; gap: 5px; }
.cursor-btn {
    background: rgba(255,255,255,0.1);
    border: none;
    border-radius: 4px;
    padding: 4px 8px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: 0.2s;
}
.cursor-btn.active { background: var(--primary); color: white; }

/* Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
.action-buttons { display: flex; gap: 8px; }
.btn {
    padding: 6px 12px;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    color: white;
    font-family: inherit;
    transition: 0.2s;
    white-space: nowrap;
}
.btn-primary { background: linear-gradient(to right, #3b82f6, #2563eb); }

/* ØªØ®ØµÙŠØµ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± */
input[type=range] {
    -webkit-appearance: none; width: 80px; height: 4px;
    background: rgba(255,255,255,0.2); border-radius: 2px; outline: none; margin: 0 5px;
}
input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none; width: 12px; height: 12px;
    border-radius: 50%; background: var(--primary); cursor: pointer; border: 2px solid white;
}

.btn-secondary { background: rgba(255,255,255,0.1); }
.btn-danger { background: linear-gradient(to right, #ef4444, #dc2626); }
.btn:hover { opacity: 0.9; transform: translateY(-1px); }

/* ÙˆØ¶Ø¹ Ø§Ù„Ø·Ø§Ù„Ø¨ (Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ø¯ÙˆØ§Øª) */
body.student-mode .tools-scroll-area { display: none !important; }
body.student-mode #clearBtn { display: none !important; }
body.student-mode #undoBtn { display: none !important; }
body.student-mode #uploadImgBtn { display: none !important; }
body.student-mode #createPollBtn { display: none !important; }
body.student-mode .toggle-handle { display: none !important; }

/* Ù…Ø³Ø±Ø­ Ø§Ù„Ø±Ø³Ù… ÙˆØ§Ù„Ù†ÙŠÙˆÙ† */
.main-stage {
    width: 100%; height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 0; /* Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© */
    box-sizing: border-box;
    background-color: var(--bg-color); /* Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ© Ù„Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„ÙØ§Ø±ØºØ© */
}

.canvas-wrapper {
    /* Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø¹Ø¨Ø± JS Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø³Ø¨Ø© */
    background: white;
    border-radius: 0;
    position: relative;
    overflow: hidden;
    /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†ÙŠÙˆÙ† Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ */
    box-shadow: 0 0 0px transparent; 
    border: none;
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    touch-action: none; /* Ø¶Ø±ÙˆØ±ÙŠ Ù„Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙŠØ¯ÙˆÙŠ ÙÙŠ Ø§Ù„Ù„Ù…Ø³ */
    transition: box-shadow 0.5s ease, border-color 0.5s ease;
    box-shadow: 0 0 30px #00eaff, 0 0 60px #00eaff; /* Ù†ÙŠÙˆÙ† Ù‚ÙˆÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠ */
    border: 2px solid #00eaff;
}

canvas { display: block; width: 100%; height: 100%; touch-action: none; }

/* Ø§Ù„Ø´Ø§Øª */
.chat-container {
    position: fixed; bottom: 20px; right: 20px; width: 300px; height: 400px;
    background: var(--panel-bg); backdrop-filter: blur(15px);
    border-radius: 16px; border: 1px solid rgba(255,255,255,0.1);
    display: flex; flex-direction: column; z-index: 2000;
    transition: transform 0.3s;
}
.chat-container.closed { transform: translateX(120%); }
.chat-header {
    padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1);
    display: flex; justify-content: space-between; font-weight: bold;
}
.chat-messages {
    flex: 1; overflow-y: auto; padding: 10px; display: flex; flex-direction: column; gap: 8px;
}
.chat-input-area {
    padding: 10px; display: flex; gap: 5px; border-top: 1px solid rgba(255,255,255,0.1);
    align-items: center;
}
.chat-input-area input {
    flex: 1; padding: 8px; border-radius: 20px; border: none; outline: none;
}
.icon-btn-small { background: none; border: none; cursor: pointer; font-size: 1.2rem; padding: 0 5px; transition: 0.2s; }
.icon-btn-small:hover { transform: scale(1.1); }

/* ÙÙ‚Ø§Ø¹Ø§Øª Ø§Ù„Ø´Ø§Øª */
.msg {
    max-width: 80%; padding: 8px 12px; border-radius: 12px; font-size: 0.9rem; word-wrap: break-word;
}
.msg.self {
    align-self: flex-end; /* ÙŠÙ…ÙŠÙ† Ù„Ù„Ø´Ø®Øµ Ø§Ù„Ø£ÙˆÙ„ (Ø£Ù†Ø§) */
    background: var(--primary); color: white;
    border-bottom-left-radius: 2px;
}
.msg.other {
    align-self: flex-start; /* ÙŠØ³Ø§Ø± Ù„Ù„Ø´Ø®Øµ Ø§Ù„Ø¢Ø®Ø± */
    background: rgba(255,255,255,0.1); color: var(--text);
    border-bottom-right-radius: 2px;
}
.chat-msg-img { max-width: 100%; border-radius: 8px; margin-top: 5px; display: block; }

/* Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
.notification-toast {
    position: fixed; top: 90px; left: 50%; transform: translateX(-50%) translateY(-150%);
    background: var(--primary); color: white; padding: 10px 20px; border-radius: 20px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3); z-index: 3000;
    transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.3s;
    font-weight: bold;
    pointer-events: none;
    opacity: 0;
}
.notification-toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

/* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø°Ù */
.context-menu {
    position: fixed; background: rgba(15, 23, 42, 0.95); border: 1px solid rgba(255,255,255,0.1);
    border-radius: 8px; display: none; flex-direction: column; z-index: 4000;
    backdrop-filter: blur(10px); overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.5);
    min-width: 150px;
}
.context-menu div {
    padding: 12px 15px; cursor: pointer; color: var(--text); font-size: 0.9rem; border-bottom: 1px solid rgba(255,255,255,0.05);
}
.context-menu div:last-child { border-bottom: none; }
.context-menu div:hover { background: rgba(255,255,255,0.1); }
}

/* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªØµÙ„ÙŠÙ† */
.users-panel {
    position: fixed; top: 90px; left: 20px; width: 200px; max-height: 400px;
    background: var(--panel-bg); backdrop-filter: blur(15px);
    border-radius: 16px; border: 1px solid rgba(255,255,255,0.1);
    display: flex; flex-direction: column; z-index: 2000;
    transition: transform 0.3s, opacity 0.3s;
    transform: translateX(0); opacity: 1;
}
.users-panel.closed { transform: translateX(-120%); opacity: 0; pointer-events: none; }
.users-list { padding: 10px; overflow-y: auto; }
.user-item { 
    padding: 8px; border-bottom: 1px solid rgba(255,255,255,0.05); 
    font-size: 0.9rem; display: flex; align-items: center; gap: 8px;
}
.user-item:before { content: 'ğŸ‘¤'; font-size: 0.8rem; }
.user-item:last-child { border-bottom: none; }

/* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
@media (max-width: 768px) {
    .header-content { padding: 5px 10px; gap: 5px; flex-wrap: wrap; min-height: auto; }
    .app-title { display: none; } /* Ø§Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ø³Ù… Ù„ØªÙˆÙÙŠØ± Ù…Ø³Ø§Ø­Ø© */
    .tool-group label { display: none; } /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªØ³Ù…ÙŠØ§Øª ÙÙŠ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
    .color-dot { width: 18px; height: 18px; }
    .btn { padding: 5px 10px; font-size: 0.8rem; }
    .action-buttons { flex-direction: row; gap: 8px; margin-left: auto; }
    
    /* ØªØ­Ø³ÙŠÙ† Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
    .tools-scroll-area { 
        order: 3; 
        width: 100%; 
        padding-top: 10px; 
        border-top: 1px solid rgba(255,255,255,0.05);
    }
}

/* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØµÙˆÙŠØª */
.modal {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.85); z-index: 5000;
    display: flex; justify-content: center; align-items: center;
}
.modal.closed { display: none; }
.modal-content {
    background: var(--panel-bg); padding: 25px; border-radius: 16px;
    border: 1px solid var(--primary); width: 320px; text-align: center;
    backdrop-filter: blur(10px); box-shadow: 0 0 30px rgba(0,0,0,0.5);
}
.poll-panel {
    position: fixed; top: 100px; right: 20px; width: 260px;
    background: rgba(15, 23, 42, 0.95); padding: 15px; border-radius: 12px;
    border: 1px solid #ffd700; z-index: 1500;
    color: white; backdrop-filter: blur(10px);
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.2);
}
.poll-panel.closed { display: none; }
.poll-option-btn {
    display: block; width: 100%; margin: 8px 0; padding: 10px;
    background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);
    color: white; cursor: pointer; border-radius: 8px; transition: 0.2s;
}
.poll-option-btn:hover { background: rgba(255,255,255,0.2); transform: translateX(-5px); }
.poll-bar {
    height: 6px; background: linear-gradient(to right, #3b82f6, #2563eb);
    margin-top: 4px; border-radius: 3px; transition: width 0.5s;
}